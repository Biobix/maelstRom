"0","TripletDF <- read.table(""phase_triplet_celegans2_woSTOP.csv"", sep = "","", header = TRUE) # read in data"
"0","TripletDF$sampleID <- paste(TripletDF$genotype, TripletDF$rep, sep = ""."") # create a unique ID for every sample"
"0",""
"0","TDF2 <- data.frame(matrix(nrow = length(unique(TripletDF$sampleID)), ncol = length(unique(TripletDF$triplet))+2))"
"0","colnames(TDF2) <- c(""sampleID"", ""genotype"", unique(TripletDF$triplet))"
"0","TDF2$sampleID <- unique(TripletDF$sampleID)"
"0",""
"0","for(S in TDF2$sampleID){"
"0","  TDF2$genotype[TDF2$sampleID==S] <- (TripletDF$genotype[TripletDF$sampleID==S])[1]"
"0","  for(Trip in unique(TripletDF$triplet)){"
"0","    #print(Trip)"
"0","    TDF2[TDF2$sampleID==S, colnames(TDF2)==Trip] <-"
"0","      TripletDF$sum.count.[TripletDF$sampleID==S & TripletDF$triplet == Trip]"
"0","  }"
"0","}"
"0",""
"0",""
"0","TDF2_scale <- scale(TDF2[,c(-1, -2)]) # I scale because I want every triplet to contribute equally,"
"0"," # if I don't scale then the most high-count triplets are likely to be the most variable as well,"
"0"," # in terms of absolute count. Scaling puts everything in relative terms, so that even low-count"
"0"," # triplets can contribute if they vary a lot relative to their own lower-count scale."
"0","TDF2_dist <- dist(TDF2_scale)"
"0","TDF2_mds <- mds(delta = TDF2_dist, ndim = 2)"
"0",""
"0","PlotDat2 <- cbind(as.data.frame(TDF2_mds$conf), TDF2$genotype)"
"0","colnames(PlotDat2) <- c(""D1"", ""D2"", ""genotype"")"
"0",""
"0","ggplot() + geom_point(data = PlotDat2, mapping = aes(x = D1, y = D2, color = genotype)) + "
"0","  labs(title = ""MDS plot of triplet data"") + theme(axis.text.x=element_blank(), axis.text.y=element_blank())+"
"0","  scale_color_manual(values= my_colors)  + "
"0","  theme_bw()"
