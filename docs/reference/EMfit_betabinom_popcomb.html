<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Models and estimates the allelic shift for cis-eQTL data, using beta-binomial models. — EMfit_betabinom_popcomb • maelstRom</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Models and estimates the allelic shift for cis-eQTL data, using beta-binomial models. — EMfit_betabinom_popcomb"><meta property="og:description" content="EMfit_betabinom_popcomb, similar to EMfit_betabinom, fits a beta-binomial mixture model to input reference- and allele RNAseq counts,
but with those counts originating from two different populations (a control- and case-population). All distribution models are jointly fitted except
for the heterozygous overdispersion parameters, which is allowed to differ between the populations. The main purpose of this fit is getting this model's
likelihood to be used in a likelihood ratio test, checking for statistical evidence that this heterozygous overdispersion parameter 
truly differs between the populations, which would indicate differential allelic divergence."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">maelstRom</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/maelstRom_Allelic_Dispersion_tutorial.html">maelstRom Allelic Dispersion tutorial</a>
    </li>
    <li>
      <a href="../articles/maelstRom_imprinting_tutorial.html">maelstRom imprinting tutorial</a>
    </li>
    <li>
      <a href="../articles/maelstRom_results_exploration.html">maelstRom results exploration</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Models and estimates the allelic shift for cis-eQTL data, using beta-binomial models.</h1>
    
    <div class="hidden name"><code>EMfit_betabinom_popcomb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>EMfit_betabinom_popcomb</code>, similar to <code>EMfit_betabinom</code>, fits a beta-binomial mixture model to input reference- and allele RNAseq counts,
but with those counts originating from two different populations (a control- and case-population). All distribution models are jointly fitted except
for the heterozygous overdispersion parameters, which is allowed to differ between the populations. The main purpose of this fit is getting this model's
likelihood to be used in a likelihood ratio test, checking for statistical evidence that this heterozygous overdispersion parameter 
truly differs between the populations, which would indicate differential allelic divergence.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">EMfit_betabinom_popcomb</span><span class="op">(</span></span>
<span>  <span class="va">data_counts</span>,</span>
<span>  allelefreq <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  <span class="va">SE</span>,</span>
<span>  inbr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  dltaco <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">6</span>,</span>
<span>  HWE <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  p_InitEst <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  p_inits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  ThetaInits <span class="op">=</span> <span class="st">"moment"</span>,</span>
<span>  ReEstThetas <span class="op">=</span> <span class="st">"moment"</span>,</span>
<span>  NoSplitHom <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  NoSplitHet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ResetThetaMin <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">10</span>,</span>
<span>  ResetThetaMax <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span>,</span>
<span>  thetaTRY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">7</span><span class="op">)</span>,</span>
<span>  probshift_init <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  FirstFewFixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  MemLim <span class="op">=</span> <span class="fl">2048</span>,</span>
<span>  Xtra <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  epsabs <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  MaxIt <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data_counts</dt>
<dd><p>Data frame. Data frame of a SNP with reference and variant counts ("ref_count" and
"var_count", respectively) for each sample ("sample"). Also required is the "isCase" column, equaling 1 for case-samples and 0 for control-samples</p></dd>


<dt>allelefreq</dt>
<dd><p>Number. Allele frequency. Only used when pInitEst is TRUE (default = 0.5)</p></dd>


<dt>SE</dt>
<dd><p>Number. Sequencing error rate.</p></dd>


<dt>inbr</dt>
<dd><p>Number. Degree of inbreeding (default = 0).</p></dd>


<dt>dltaco</dt>
<dd><p>Number. Minimal difference between 2 iterations (default = 0.001).</p></dd>


<dt>HWE</dt>
<dd><p>Logical. Should HWE be used for allele frequency estimation, not recommended (default = FALSE).</p></dd>


<dt>p_InitEst</dt>
<dd><p>Logical. Calculate initial estimates of pr, pv and prv from allelefreq, not recommended (default = FALSE).</p></dd>


<dt>ThetaInits</dt>
<dd><p>Numeric vector, "moment" or "TryThree". A vector of length two containing the initial dispersion estimate for the homozygous peaks, followed by the one for the heterozygous peak,
or "moment", in which case moment initial estimates are generated. In case of "TryThree", three initial values given by the <code>thetaTRY</code> input argument are tried out and the one yielding the best fit is retained.</p></dd>


<dt>ReEstThetas</dt>
<dd><p>String. Accepts the methods "moment" or "simple" as arguments, in which case dispersions are re-estimated during every EM-step using a moment estimate or a simple custom procedure respectively, to be used as a starting</p></dd>


<dt>NoSplitHom</dt>
<dd><p>Logical. If TRUE, don't allow the beta-binomial fits for homozygotes to be bimodal</p></dd>


<dt>NoSplitHet</dt>
<dd><p>Logical. If TRUE, don't allow the beta-binomial fit for heterozygotes to be bimodal</p></dd>


<dt>ResetThetaMin</dt>
<dd><p>Number. Initial theta values in numeric optimization get capped at this minimum (e.g. in case the moment estimate is even lower)</p></dd>


<dt>ResetThetaMax</dt>
<dd><p>Number. Initial theta values in numeric optimization get capped at this maximum (e.g. in case the moment estimate is even higher)</p></dd>


<dt>thetaTRY</dt>
<dd><p>Numeric vector. See <code>ReEstThetas</code>, in case this argument equals "TryThree".</p></dd>


<dt>probshift_init</dt>
<dd><p>Number. Initial estimate position heterozygous peak (allelic bias; expected fraction of reference reads)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list containing the following components:</p>
<dl><dt>ParamVec</dt>
<dd><p>A vector containing fitted model parameters: genotype frequencies, heterozygous peak position (allelic bias), and overdispersion of the homozygous peaks and of the separate heterozygous control- and case-peaks.</p></dd>

<dt>GenoDF</dt>
<dd><p>A dataframe containing per-samples genotypes likelihoods according to the fitted model.</p></dd>

<dt>genotypeN</dt>
<dd><p>A character vector containing the most likely per-sample genotypes according to the fitted model.</p></dd>

<dt>nrep</dt>
<dd><p>The number of iterations.</p></dd>

<dt>quality</dt>
<dd><p>An "!" indicates a bad quality locus or fit (no apparent heterozygotes)</p></dd>

</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Cedric Stroobandt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

