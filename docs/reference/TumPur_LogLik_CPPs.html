<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Various implementations of the tumor-purity-accounting (negative) log likelihood (sum of completely correlated beta-binomials) — TumPur_LogLik_CPP • maelstRom</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Various implementations of the tumor-purity-accounting (negative) log likelihood (sum of completely correlated beta-binomials) — TumPur_LogLik_CPP"><meta property="og:description" content="UNUSED. These different implementations of, in essence, the same log-likelihood (to be used in maximum likelihood estimation) use
different parameters transformations in order to find out which one is optimal for numerical optimization."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">maelstRom</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/maelstRom_Allelic_Dispersion_tutorial.html">maelstRom Allelic Dispersion tutorial</a>
    </li>
    <li>
      <a href="../articles/maelstRom_imprinting_tutorial.html">maelstRom imprinting tutorial</a>
    </li>
    <li>
      <a href="../articles/maelstRom_results_exploration.html">maelstRom results exploration</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Various implementations of the tumor-purity-accounting (negative) log likelihood (sum of completely correlated beta-binomials)</h1>
    
    <div class="hidden name"><code>TumPur_LogLik_CPPs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>UNUSED. These different implementations of, in essence, the same log-likelihood (to be used in maximum likelihood estimation) use
different parameters transformations in order to find out which one is optimal for numerical optimization.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">TumPur_LogLik_CPP</span><span class="op">(</span></span>
<span>  <span class="va">optpars</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP2</span><span class="op">(</span></span>
<span>  <span class="va">optpars</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP2X</span><span class="op">(</span></span>
<span>  <span class="va">optpars</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP3</span><span class="op">(</span></span>
<span>  <span class="va">q</span>,</span>
<span>  <span class="va">a</span>,</span>
<span>  <span class="va">b</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP3X</span><span class="op">(</span></span>
<span>  <span class="va">q</span>,</span>
<span>  <span class="va">a</span>,</span>
<span>  <span class="va">b</span>,</span>
<span>  <span class="va">qlim</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP4</span><span class="op">(</span></span>
<span>  <span class="va">q</span>,</span>
<span>  <span class="va">a</span>,</span>
<span>  <span class="va">b</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP_DB1</span><span class="op">(</span></span>
<span>  <span class="va">optpars</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP_DB2</span><span class="op">(</span></span>
<span>  <span class="va">optpars</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP_DB3</span><span class="op">(</span></span>
<span>  <span class="va">optpars</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP2_10</span><span class="op">(</span></span>
<span>  <span class="va">optpars</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP2_100</span><span class="op">(</span></span>
<span>  <span class="va">optpars</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP2_1000</span><span class="op">(</span></span>
<span>  <span class="va">optpars</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TumPur_LogLik_CPP2Y</span><span class="op">(</span></span>
<span>  <span class="va">optpars</span>,</span>
<span>  <span class="va">ref_counts</span>,</span>
<span>  <span class="va">var_counts</span>,</span>
<span>  <span class="va">tumpur</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">SCPthreshold</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  NumIntMethod <span class="op">=</span> <span class="st">"Gregory"</span>,</span>
<span>  prec <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Wvec <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  Nvec <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>optpars</dt>
<dd><p>Numeric vector. To be optimized parameters, usually consisting of the beta-binomial alpha (a) and beta (b) parameter,
and a q-parameters denoting their difference (multiplicative factor) in cases compared to controls (same pi assumed, different theta;
complete correlation within a sample assumed as well).</p></dd>


<dt>ref_counts</dt>
<dd><p>Numeric vector. Vector of reference allele counts.</p></dd>


<dt>var_counts</dt>
<dd><p>Numeric vector. Vector of variant allele counts.</p></dd>


<dt>tumpur</dt>
<dd><p>Numeric vector. Vector of tumor purities (or an estimate thereof) at expression-level.</p></dd>


<dt>weights</dt>
<dd><p>Numeric vector. Weights to be used for returning a weighted log-likelihood (sample-wise multiplication of log-likelihood with these weights).</p></dd>


<dt>SCPthreshold</dt>
<dd><p>Number. Every sample's corresponding tumor purity is used to model binomial sampling of tumor- and control reads making up the tumor observations.
More specifically, every possible sampling's probability is tracked, and its corresponding log-likelihood (of the sum of completely correlated beta-binomials) calculated.
This might be a bit overkill however; when SCPthreshold is specified, only the most likely binomial read sampling are taken into account, up until their total binomial
probability sums to SCPthreshold. When SCPthreshold is set to 0, only the single most likely sampling is taken into account.</p></dd>


<dt>n</dt>
<dd><p>Number. Number of intervals to be used during calculations of sum-of-completely-correlated-beta-binomial likelihood via numerical integration,
when the used integration method (NumIntMethod) is either the modified trapezoidal method using Gregory weights ("Gregory") or Tanh-sinh quadrature ("TanhSinhQuad")</p></dd>


<dt>NumIntMethod</dt>
<dd><p>String. Used numeric integration method (see above); either the modified trapezoidal method using Gregory weights ("Gregory"),
Tanh-sinh quadrature ("TanhSinhQuad"), Newton Cotes ("NewtonCotes"), or Gaussian quadrature ("GaussianQuad").</p></dd>


<dt>prec</dt>
<dd><p>Number. A low number (e.g. 0.0001) acting as stop criterion when NumIntMethod == "TanhSinhQuad"
(its iterative calculations stops if the current calculation differs less then prec from the previous one).</p></dd>


<dt>Wvec</dt>
<dd><p>Numeric vector. Vector of numeric integration weights used when NumIntMethod == "NewtonCotes", or NumIntMethod == "GaussianQuad".</p></dd>


<dt>Nvec</dt>
<dd><p>Numeric vector. Vector of node values used when NumIntMethod == "GaussianQuad".</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Negative log-likelihood.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Cedric Stroobandt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

