<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot maelstRom's EM-fit results. — maelstRom_EMfitplot • maelstRom</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot maelstRom's EM-fit results. — maelstRom_EMfitplot"><meta name="description" content="maelstRom_EMfitplot plots the results of maelstRom's beta-binomial EM-fit. More specifically, it plots both the observed reference allele fractions as a histogram (optionally scaled
to a single total count parameter, see ScaleHist and ScaleCount) and the parameters yielded by the EM-fit as beta-binomial PMFs (assuming a total read counts ScaleCount
and compressed to the zero-to-one interval of the reference allele fraction instead of integer reference counts). Optionally, the unshifted fit assuming no allelic bias (heterozygous
pi-parameter = 0.5) is plotted as well, if plot_NoShift is TRUE and its distributional parameters are provided as input."><meta property="og:description" content="maelstRom_EMfitplot plots the results of maelstRom's beta-binomial EM-fit. More specifically, it plots both the observed reference allele fractions as a histogram (optionally scaled
to a single total count parameter, see ScaleHist and ScaleCount) and the parameters yielded by the EM-fit as beta-binomial PMFs (assuming a total read counts ScaleCount
and compressed to the zero-to-one interval of the reference allele fraction instead of integer reference counts). Optionally, the unshifted fit assuming no allelic bias (heterozygous
pi-parameter = 0.5) is plotted as well, if plot_NoShift is TRUE and its distributional parameters are provided as input."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">maelstRom</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/maelstRom_Allelic_Dispersion_tutorial.html">maelstRom Allelic Dispersion tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/maelstRom_imprinting_tutorial.html">maelstRom imprinting tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/maelstRom_results_exploration.html">maelstRom results exploration</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot maelstRom's EM-fit results.</h1>

      <div class="d-none name"><code>maelstRom_EMfitplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>maelstRom_EMfitplot</code> plots the results of maelstRom's beta-binomial EM-fit. More specifically, it plots both the observed reference allele fractions as a histogram (optionally scaled
to a single total count parameter, see <code>ScaleHist</code> and <code>ScaleCount</code>) and the parameters yielded by the EM-fit as beta-binomial PMFs (assuming a total read counts <code>ScaleCount</code>
and compressed to the zero-to-one interval of the reference allele fraction instead of integer reference counts). Optionally, the unshifted fit assuming no allelic bias (heterozygous
pi-parameter = 0.5) is plotted as well, if <code>plot_NoShift</code> is TRUE and its distributional parameters are provided as input.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">maelstRom_EMfitplot</span><span class="op">(</span></span>
<span>  ref_counts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var_counts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_hom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_het <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pr_NoShift <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prv_NoShift <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pv_NoShift <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_hom_NoShift <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_het_NoShift <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">probshift</span>,</span>
<span>  <span class="va">SE</span>,</span>
<span>  MinCount <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ScaleCount <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  ScaleHist <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nbins <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  plot_NoShift <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  SplitPeaks <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ShiftCols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  NoShiftCol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  wd_res <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chr <span class="op">=</span> <span class="st">""</span>,</span>
<span>  position <span class="op">=</span> <span class="st">""</span>,</span>
<span>  gene <span class="op">=</span> <span class="st">""</span>,</span>
<span>  DataList_out <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Geno_AB_res <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dAD_res <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  PlotWhich <span class="op">=</span> <span class="st">"choose"</span>,</span>
<span>  BG <span class="op">=</span> <span class="st">"#F2F2F2"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ref-counts">ref_counts<a class="anchor" aria-label="anchor" href="#arg-ref-counts"></a></dt>
<dd><p>Numeric vector. Reference counts.</p></dd>


<dt id="arg-var-counts">var_counts<a class="anchor" aria-label="anchor" href="#arg-var-counts"></a></dt>
<dd><p>Numeric vector. Variant counts.</p></dd>


<dt id="arg-pr">pr<a class="anchor" aria-label="anchor" href="#arg-pr"></a></dt>
<dd><p>Number. Reference homozygote genotype probability of the locus.</p></dd>


<dt id="arg-prv">prv<a class="anchor" aria-label="anchor" href="#arg-prv"></a></dt>
<dd><p>Number. Heterozygote genotype probability of the locus.</p></dd>


<dt id="arg-pv">pv<a class="anchor" aria-label="anchor" href="#arg-pv"></a></dt>
<dd><p>Number. Variant homozygote genotype probability of the locus.</p></dd>


<dt id="arg-theta-hom">theta_hom<a class="anchor" aria-label="anchor" href="#arg-theta-hom"></a></dt>
<dd><p>Number. The dispersion parameter of the homozygous peaks.</p></dd>


<dt id="arg-theta-het">theta_het<a class="anchor" aria-label="anchor" href="#arg-theta-het"></a></dt>
<dd><p>Number. The dispersion parameter of the heterozygous peak.</p></dd>


<dt id="arg-pr-noshift">pr_NoShift<a class="anchor" aria-label="anchor" href="#arg-pr-noshift"></a></dt>
<dd><p>Number. Reference homozygote genotype probability of the locus under the null hypothesis fit (no allelic bias; heterozygous pi-parameter = 0.5).</p></dd>


<dt id="arg-prv-noshift">prv_NoShift<a class="anchor" aria-label="anchor" href="#arg-prv-noshift"></a></dt>
<dd><p>Number. Heterozygote genotype probability of the locus under the null hypothesis fit (no allelic bias; heterozygous pi-parameter = 0.5).</p></dd>


<dt id="arg-pv-noshift">pv_NoShift<a class="anchor" aria-label="anchor" href="#arg-pv-noshift"></a></dt>
<dd><p>Number. Variant homozygote genotype probability of the locus under the null hypothesis fit (no allelic bias; heterozygous pi-parameter = 0.5).</p></dd>


<dt id="arg-theta-hom-noshift">theta_hom_NoShift<a class="anchor" aria-label="anchor" href="#arg-theta-hom-noshift"></a></dt>
<dd><p>Number. The dispersion parameter of the homozygous peaks under the null hypothesis fit (no allelic bias; heterozygous pi-parameter = 0.5).</p></dd>


<dt id="arg-theta-het-noshift">theta_het_NoShift<a class="anchor" aria-label="anchor" href="#arg-theta-het-noshift"></a></dt>
<dd><p>Number. The dispersion parameter of the heterozygous peak under the null hypothesis fit (no allelic bias; heterozygous pi-parameter = 0.5).</p></dd>


<dt id="arg-probshift">probshift<a class="anchor" aria-label="anchor" href="#arg-probshift"></a></dt>
<dd><p>Number. The reference allele fraction in heterozygotes, indicating allelic bias when deviating from 0.5</p></dd>


<dt id="arg-se">SE<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>Number. Sequencing error rate.</p></dd>


<dt id="arg-mincount">MinCount<a class="anchor" aria-label="anchor" href="#arg-mincount"></a></dt>
<dd><p>Number. A minimal count filter for plotting only; samples with a lower count will not be included in the plotted histogram.</p></dd>


<dt id="arg-scalecount">ScaleCount<a class="anchor" aria-label="anchor" href="#arg-scalecount"></a></dt>
<dd><p>Number. Even though the observed number of reads can vary per sample, we have to assume a single number of observed reads to plot PMFs. One can opt to pick
a set value for this (the default is 50) or e.g. use the locus' median or mean coverage here, so as to best correspond to the observed data.</p></dd>


<dt id="arg-scalehist">ScaleHist<a class="anchor" aria-label="anchor" href="#arg-scalehist"></a></dt>
<dd><p>Logical. See the remark given at <code>ScaleCount</code>; if TRUE, tranforms the input data to all have the same total allele counts <code>ScaleCount</code>, with the actual number
of reference reads being determined as the quantile function assuming <code>ScaleCount</code> total counts with the same probability as the observed data (this probability being calculated
with the actually observed number of counts). The idea here is to better reflect how well the observed data corresponds to the fitted PMF, which is plotted for a single number of observed reads.</p></dd>


<dt id="arg-nbins">nbins<a class="anchor" aria-label="anchor" href="#arg-nbins"></a></dt>
<dd><p>Number. Number of bins for the histogram depicting the observed reference allele fractions.</p></dd>


<dt id="arg-plot-noshift">plot_NoShift<a class="anchor" aria-label="anchor" href="#arg-plot-noshift"></a></dt>
<dd><p>Logical. If TRUE, also plots the PMF of the unshifted fit (no allelic bias; heterozygous pi-parameter = 0.5)</p></dd>


<dt id="arg-splitpeaks">SplitPeaks<a class="anchor" aria-label="anchor" href="#arg-splitpeaks"></a></dt>
<dd><p>Logical. If TRUE, the PMFs of both homozygotes and the heterozygotes are plotted seperately and using different colors. If FALSE, one total PMF of the mixture model is plotted.</p></dd>


<dt id="arg-shiftcols">ShiftCols<a class="anchor" aria-label="anchor" href="#arg-shiftcols"></a></dt>
<dd><p>String (vector). Colors for the plotted PMFs of the fit incorporating allelic bias. Three values are required if <code>SplitPeaks</code> is TRUE, otherwise just one value is required.
Default colors are used in case none are given as input.</p></dd>


<dt id="arg-noshiftcol">NoShiftCol<a class="anchor" aria-label="anchor" href="#arg-noshiftcol"></a></dt>
<dd><p>String. Color for the unshifted PMF (no allelic bias; heterozygous pi-parameter = 0.5). There's no option to split the peaks of this unshifted fit as it would make
the final figure way too clustered, so only one color value is required. A default color is used in case non is given as input.</p></dd>


<dt id="arg-wd-res">wd_res<a class="anchor" aria-label="anchor" href="#arg-wd-res"></a></dt>
<dd><p>String. Working directory where plots are saved; if non is given, the plot itself (as a <code>ggplot2</code> object) is returned instead.</p></dd>


<dt id="arg-chr">chr<a class="anchor" aria-label="anchor" href="#arg-chr"></a></dt>
<dd><p>Number. Chromosome of the locus, to be used in naming the output file if a <code>wd_res</code> is given.</p></dd>


<dt id="arg-position">position<a class="anchor" aria-label="anchor" href="#arg-position"></a></dt>
<dd><p>Number. Position of the locus, to be used in naming the output file if a <code>wd_res</code> is given.</p></dd>


<dt id="arg-gene">gene<a class="anchor" aria-label="anchor" href="#arg-gene"></a></dt>
<dd><p>String. Gene the locus is part of, to be used in naming the output file if a <code>wd_res</code> is given; optional.</p></dd>


<dt id="arg-datalist-out">DataList_out<a class="anchor" aria-label="anchor" href="#arg-datalist-out"></a></dt>
<dd><p>Dataframe. Alternatively, <code>maelstRom_EMfitplot</code> accepts a dataframes containing per-sample data of the locus of interest. From this, it can
infer its <code>ref_counts</code>, <code>var_counts</code>, <code>pr_NoShift</code>, <code>prv_NoShift</code> and <code>pv_NoShift</code> arguments. This is possible
as long as <code>EMfit_betabinom_robust</code> was run on this dataframe with its <code>fitH0</code> argument set to TRUE.</p></dd>


<dt id="arg-geno-ab-res">Geno_AB_res<a class="anchor" aria-label="anchor" href="#arg-geno-ab-res"></a></dt>
<dd><p>Dataframe with 1 row. Alternatively, <code>maelstRom_EMfitplot</code> accepts a dataframe containing beta-binomial mixture model EM-fit results from calling <code>EMfit_betabinom_robust</code>'s
wrapper function <code>BetaBinomGenotyping</code>. As such, expected columns are listed on <code>BetaBinomGenotyping</code>'s help page, more specifically
its produced <code>Geno_AB_res</code> output. The one row provided must correspond to the locus of interest. From this, <code>maelstRom_EMfitplot</code> can
infer its <code>pr</code>, <code>prv</code>, <code>pv</code>, <code>theta_hom</code>, <code>theta_het</code>, <code>theta_hom_NoShift</code>, <code>theta_het_NoShift</code> and <code>probshift</code> arguments.</p></dd>


<dt id="arg-dad-res">dAD_res<a class="anchor" aria-label="anchor" href="#arg-dad-res"></a></dt>
<dd><p>Dataframe with 1 row. Alternatively, <code>maelstRom_EMfitplot</code> accepts a dataframe containing beta-binomial mixture model EM-fit results from calling <code>EMfit_betabinom_popcomb</code>'s
wrapper function <code>dAD_analysis</code>. As such, expected columns are listed on <code>dAD_analysis</code>'s help page, more specifically
its produced <code>dAD_res</code> output. The one row provided must correspond to the locus of interest. From this, <code>maelstRom_EMfitplot</code> can
infer its <code>pr</code>, <code>prv</code>, <code>pv</code>, <code>theta_hom</code>, <code>theta_het</code>, and <code>probshift</code> arguments. The "NoShift" case can not be plotted in this scenario,
as dAD-detection happens without AB-detection. If <code>dAD_res</code> is not NULL, <code>Geno_AB_res</code> has to be NULL and vice-versa. Also, when using <code>dAD_res</code>,
you need to specify whether to plot controls or cases using the <code>PlotWhich</code> argument.</p></dd>


<dt id="arg-plotwhich">PlotWhich<a class="anchor" aria-label="anchor" href="#arg-plotwhich"></a></dt>
<dd><p>String. Either "control" or "case", to know which data to fetch from <code>dAD_res</code> for plotting.
The dataframe given as the <code>DataList_out</code> argument should of course be of the corresponding population.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cedric Stroobandt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

