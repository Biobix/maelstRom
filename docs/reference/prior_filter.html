<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prior filtering of loci. — prior_filter • maelstRom</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prior filtering of loci. — prior_filter"><meta name="description" content="prior_filter filters loci prior to analysis using maelstRom:
a filter throwing out samples showcasing relevant allele counts for alleles not present in the ref_alleles column (if checkref_filter == TRUE)
a filter throwing out loci showcasing a low minor allele fraction (if prior_allelefreq_filter == TRUE, governed by min_PrioAlleleFreq)
a filter for median coverage (governed by min_median_cov, only looking at ref_count and var_count)
a filter for the number of samples (governed by min_nr_samples)
Also, samples having zero-counts in both &quot;ref_count&quot; and &quot;var_count&quot; are discarded, as they're useless in further analyses."><meta property="og:description" content="prior_filter filters loci prior to analysis using maelstRom:
a filter throwing out samples showcasing relevant allele counts for alleles not present in the ref_alleles column (if checkref_filter == TRUE)
a filter throwing out loci showcasing a low minor allele fraction (if prior_allelefreq_filter == TRUE, governed by min_PrioAlleleFreq)
a filter for median coverage (governed by min_median_cov, only looking at ref_count and var_count)
a filter for the number of samples (governed by min_nr_samples)
Also, samples having zero-counts in both &quot;ref_count&quot; and &quot;var_count&quot; are discarded, as they're useless in further analyses."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">maelstRom</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/maelstRom_Allelic_Dispersion_tutorial.html">maelstRom Allelic Dispersion tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/maelstRom_imprinting_tutorial.html">maelstRom imprinting tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/maelstRom_results_exploration.html">maelstRom results exploration</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prior filtering of loci.</h1>

      <div class="d-none name"><code>prior_filter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>prior_filter</code> filters loci prior to analysis using maelstRom:</p><ul><li><p>a filter throwing out samples showcasing relevant allele counts for alleles not present in the ref_alleles column (if checkref_filter == TRUE)</p></li>
<li><p>a filter throwing out loci showcasing a low minor allele fraction (if prior_allelefreq_filter == TRUE, governed by min_PrioAlleleFreq)</p></li>
<li><p>a filter for median coverage (governed by min_median_cov, only looking at ref_count and var_count)</p></li>
<li><p>a filter for the number of samples (governed by min_nr_samples)</p></li>
</ul><p>Also, samples having zero-counts in both "ref_count" and "var_count" are discarded, as they're useless in further analyses.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prior_filter</span><span class="op">(</span></span>
<span>  <span class="va">data_pos</span>,</span>
<span>  min_median_cov <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  min_nr_samples <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  checkref_filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prior_allelefreq_filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  min_PriorAlleleFreq <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-pos">data_pos<a class="anchor" aria-label="anchor" href="#arg-data-pos"></a></dt>
<dd><p>Data frame. Data frame of a SNP position with columns:
"ref_alleles", "A", "T", "C", "G", "ref", "var", "ref_count" and "var_count".</p></dd>


<dt id="arg-min-median-cov">min_median_cov<a class="anchor" aria-label="anchor" href="#arg-min-median-cov"></a></dt>
<dd><p>Number. Minimal median coverage necessary to retain locus (default is 5).</p></dd>


<dt id="arg-min-nr-samples">min_nr_samples<a class="anchor" aria-label="anchor" href="#arg-min-nr-samples"></a></dt>
<dd><p>Number. Minimal number of samples necessary to retain locus (default is 30).</p></dd>


<dt id="arg-checkref-filter">checkref_filter<a class="anchor" aria-label="anchor" href="#arg-checkref-filter"></a></dt>
<dd><p>Logical. Should samples with a high allele count of alleles not present in the ref_alleles column of data_pos be filtered out?
With "high", we mean either the highest allele count in that sample, OR the second highest if there's heuristic evidence that the sample is not homozygous for its most common allele.
The particular check involves, for each sample, extracting its first and second most common allele, then using the entire population data in <code>data_pos</code> to get
genotype probabilities for homozygocity in the most common allele and heterozygosity in these alleles, using these allele's observed population frequencies and assuming
Hardy-Weinberg Equilibrium (inbreeding parameter = 0). These are then multiplied with that particular sample's corresponding evidence for homozygocity of the most common allele
(using a multinomial distribution assuming equal observed frequencies for all other alleles, which should be low and are dictated by e.g. sequencing errors)
and evidence for heterozygosity if its most common alleles (using a multinomial distribution assuming equal expression of these two alleles which should be high,
and equal expression of the two remaining nucleotides which should be low, and dictated by e.g. sequencing error rate).</p></dd>


<dt id="arg-prior-allelefreq-filter">prior_allelefreq_filter<a class="anchor" aria-label="anchor" href="#arg-prior-allelefreq-filter"></a></dt>
<dd><p>Logical. Should loci be filtered using a minimal prior minor allele frequency,
which is simply determined as the percent occurrence of the less common (variant) allele across nucleotides. (default is FALSE).</p></dd>


<dt id="arg-min-priorallelefreq">min_PriorAlleleFreq<a class="anchor" aria-label="anchor" href="#arg-min-priorallelefreq"></a></dt>
<dd><p>Number. Prior allele frequency to filter SNPs on if <code>prior_allelefreq_filter</code> is TRUE (default is 0.1).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The data as data frame with total and median coverage or NULL if the SNP positions was filtered.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cedric Stroobandt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

